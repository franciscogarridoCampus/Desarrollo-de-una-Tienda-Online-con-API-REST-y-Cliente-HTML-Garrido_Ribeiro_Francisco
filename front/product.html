<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Producto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5" id="contenido"></div>

<script>
const storeP = JSON.parse(localStorage.getItem("store"));
const paramsP = new URLSearchParams(window.location.search);
const id = parseInt(paramsP.get("id"));

const producto = storeP.productos.find(p => p.id === id);

// Añadir a vistos recientemente
let vistos = JSON.parse(localStorage.getItem("vistos")) || [];
vistos.unshift(producto);
vistos = [...new Set(vistos.map(v => v.id))].map(id => storeP.productos.find(p => p.id === id));
vistos = vistos.slice(0, 5);
localStorage.setItem("vistos", JSON.stringify(vistos));

document.getElementById("contenido").innerHTML = `
<div class="card p-4 shadow">
    <h2>${producto.nombre}</h2>
    <p>${producto.descripcion}</p>
    <h3>${producto.precio}€</h3>
    <button class="btn btn-success" onclick="addToCart()">Añadir al carrito</button>
</div>`;

function addToCart() {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.push(producto);
    localStorage.setItem("cart", JSON.stringify(cart));
    alert("Producto añadido");
}
</script>

</body>
</html>
